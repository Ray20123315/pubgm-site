<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PUBGM å¥½å‹æ¨è–¦åŠ LINE ç¤¾ç¾¤</title>
  <link rel="stylesheet" href="style.css" />
  <!-- PapaParse CSV è§£æå™¨ -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  <style>
    /* ç°¡å–®ç¤ºç¯„ CSS æŒ‰éˆ•ç½®ä¸­å’Œå¡ç‰‡æ ¼å¼ */
    body {
      font-family: "Noto Sans TC", "Microsoft JhengHei", sans-serif;
      margin: 10px 15px;
      background-color: #f9f9f9;
      color: #333;
    }
    header, main, footer {
      max-width: 720px;
      margin: 0 auto 20px auto;
    }
    h1, h2 {
      text-align: center;
    }
    .btn {
      display: inline-block;
      background: #06c755;
      color: white;
      padding: 10px 16px;
      margin: 8px auto;
      border-radius: 6px;
      text-decoration: none;
      font-weight: bold;
      font-size: 1.1em;
      cursor: pointer;
      user-select: none;
    }
    .btn:hover {
      background: #05a94f;
    }
    #social-links, #feedback {
      text-align: center;
      margin: 15px 0;
    }
    #teammate-list {
      margin-top: 15px;
    }
    .teammate-card {
      background: white;
      border-radius: 8px;
      box-shadow: 0 0 6px rgba(0,0,0,0.1);
      padding: 12px 16px;
      margin-bottom: 15px;
      line-height: 1.5em;
    }
  </style>
</head>
<body>
  <header>
    <h1>ğŸ¯ PUBGM å¥½å‹æ¨è–¦åŠ LINE ç¤¾ç¾¤</h1>
    <p style="text-align:center;">æ­¡è¿ä¾†åˆ° PUBGM å¥½å‹æ¨è–¦åŠ LINE ç¤¾ç¾¤ï¼èšé›†æˆ°å‹ã€åˆ†äº«æŠ€å·§ã€‚</p>

    <section id="latest-news">
      <h2>ğŸ“¢ æœ€æ–°æ¶ˆæ¯</h2>
      <p>ç›®å‰é–‹æ”¾æ¸¬è©¦ç‰ˆï¼Œæ­¡è¿æœ‹å‹æ¨è–¦éšŠå‹ï¼Œä¸€èµ·ä¸Šåˆ†ï¼</p>
    </section>

    <section id="social-links">
      <h2>åŠ å…¥æˆ‘å€‘çš„ç¤¾ç¾¤</h2>
      <a href="https://line.me/ti/g2/3R7YozDVnTR4ln5XjtR7tlxcMnloRpnggGwEng?utm_source=invitation&utm_medium=link_copy&utm_campaign=default" target="_blank" class="btn line-btn">åŠ å…¥ LINE ç¤¾ç¾¤</a>
    </section>

    <section id="feedback">
      <h2>å¥½å‹æ¨è–¦</h2>
      <a href="https://forms.gle/qtwE592qaeD4Girv6" target="_blank" class="btn feedback-btn">å¡«å¯«å»ºè­°è¡¨å–®</a>
    </section>
  </header>

  <main>
    <h2>å¥½å‹æ¨è–¦ç‰†</h2>
    <div id="teammate-list">è¼‰å…¥ä¸­...</div>
  </main>

  <footer>
    <p style="text-align:center;">Â© 2025 PUBGM å¥½å‹æ¨è–¦ç‰†</p>
  </footer>

  <script>
    const sheetURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vR4C-YNnRgX3N71kURyPYn0K6Gt34uLFPm5DjiWzHf9DfKDzE3LIoEm2D8SqZoyrXycU4cIDK7qlgLd/pub?output=csv";

    function clean(value) {
      if (!value) return "";
      return value.replace(/^"+|"+$/g, "").replace(/\n/g, " / ").trim();
    }

    function displayTeammates(data) {
      const container = document.getElementById("teammate-list");
      container.innerHTML = "";

      if (data.length === 0) {
        container.innerHTML = "<p>ç›®å‰æ²’æœ‰æ¨è–¦çš„éšŠå‹ã€‚</p>";
        return;
      }

      const weekDays = ["ä¸€", "äºŒ", "ä¸‰", "å››", "äº”", "å…­", "æ—¥"];

      data.forEach(item => {
        let timesText = "";
        for (let i = 0; i < 7; i++) {
          const key = `å¹³å¸¸éŠç©æ™‚é–“(è‹¥ç•¶å¤©ä¸ç©è«‹å¡«å¯«ä¸ç©) [æ˜ŸæœŸ${weekDays[i]}]`;
          const val = clean(item[key]);
          if (val && !val.includes("ä¸ç©")) {
            timesText += `ã€€${weekDays[i]}ï¼š${val}<br>`;
          }
        }

        const card = document.createElement("div");
        card.className = "teammate-card";
        card.innerHTML = `
          <h3>ğŸ†” ${clean(item["éšŠå‹ ID"])}ï¼ˆUID: ${clean(item["éšŠå‹UID"])})</h3>
          <p>ğŸ¯ æ“…é•·è§’è‰²ï¼š${clean(item["æ“…é•·æ‰®æ¼”è§’è‰²(æ“…é•·è§’è‰²æˆ–å®šä½)"])}</p>
          <p>ğŸ“Š æŠ€è¡“è©•åƒ¹ï¼š${clean(item["æŠ€è¡“é¡å‹(è‡ªè©•)(è«‹å‹¿ç½µäºº)"])}</p>
          <p>ğŸ• å‡ºæ²’æ™‚é–“ï¼š<br>${timesText || "ç„¡è³‡æ–™"}</p>
          <p>ğŸ’¬ å‚™è¨»ï¼š${clean(item["æƒ³è£œå……çš„å…§å®¹"]) || "ç„¡"}</p>
          <p>â­ æ»¿æ„åº¦ï¼š${clean(item["æ»¿æ„åº¦"]) || "ç„¡"}</p>
          <p>ğŸ’– å–œæ„›åº¦ï¼š${clean(item["å–œæ„›åº¦"]) || "ç„¡"}</p>
        `;
        container.appendChild(card);
      });
    }

    fetch(sheetURL)
      .then(res => res.text())
      .then(csvText => {
        Papa.parse(csvText, {
          header: true,
          skipEmptyLines: true,
          complete: function(results) {
            displayTeammates(results.data);
          },
          error: function(err) {
            console.error(err);
            document.getElementById("teammate-list").innerHTML = "<p>è³‡æ–™è§£æéŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚</p>";
          }
        });
      })
      .catch(err => {
        console.error(err);
        document.getElementById("teammate-list").innerHTML = "<p>è¼‰å…¥è³‡æ–™å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚</p>";
      });
  </script>
</body>
</html>
